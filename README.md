# About this Repo

This repository contains json files that identify which shipping courier
service is associated with any given tracking number.  A shipping
courier is someone like FedEx or USPS.

- **couriers.json** - identifies the standard couriers that might send mail
  - Each courier is defined by 4 required fields, and two optional
    fields.

    - `name` - Identifies the courier
    - `regex` - A regular expression that identifies tracking number
      to a particular courier.  The regex can be a string or a list that
      should be concatenated (ie via ``` "".join(list_of_strings) ```).
      The regex contains named groups that identify important parts of
      the tracking number.  Every regex must identify a "SerialNumber"
      and "CheckDigit".
    - `check_digit_algo` - Identifies one of various kinds of check
      digit algorithms that couriers use to validate the tracking
      number.  Different couriers use different variations of
      check digit algorithms.  For a standardized implementation of
      check digit algorithms, continue reading below.
    - `tracking_url` - A url that we can use to find the tracking
      history for a particular tracking number.  It assumes the
      tracking number can be entered using python style
      string formatting "www.courier.com?trackingnumber=%s".
    - `serial_number_parser` - Optional field.  By default, assume
      couriers use the default serial number parser.  For the
      standardized list of serial number parsers, continue reading
      below.
    - `_inherits` - Optional field.  If defined, it points to a key
      in "_shared_courier_data", and couriers use this to avoid
      defining redundant information in the JSON file.
  - The "S10" courier is a special courier that represents international
    mail originating from many different countries.  The S10 standard is
    defined by the Universal Postal Union, which is "is the second
    oldest international organization worldwide" according to their
    website.  The S10 regex matches all international mail.  Files in
    this repo titled "s10_*.json" contain more detailed information.
  - A comment on the format of this json file: a courier can "inherit"


**s10_countries.json** - a list of countries where international mail
can originate from.  The file **gen_s10_countries.py** generates this
file by fetching from Universal Postal Union (UPU) website.  The regex
is the S10 regex, but specific to that country.

**s10_service_indicator.json** - the S10 protocol defines a service
indicator embedded in the tracking number that denotes what kind of mail
the tracking number represents.

**s10_overrides.json** - a list of default fields for various s10
countries.  The top-level keys in this file correspond the the country
name in **s10_countries.json**.  The sub-keys can define a `name` or `tracking_url` that should be used instead of the default value found in **s10_countries.json**.

**test_couriers.json** - test fixtures to validate that your code is
correctly using the json files.


### Standard implementations of

- [Check digit algorithms](https://github.com/adgaudio/MysteryTrackingNumber/blob/master/src/main/java/com/adgaudio/mysterytrackingnumber/CheckDigitAlgorithms.java)
- [Serial number parsers](https://github.com/adgaudio/MysteryTrackingNumber/blob/master/src/main/java/com/adgaudio/mysterytrackingnumber/SerialNumberParsers.java)


# Using this repo:

### List of Libraries using this repository, by Language

We suggest you check these out before rolling your own implementation.

Java:
  - [MysteryTrackingNumber](https://github.com/adgaudio/MysteryTrackingNumber)
Ruby:
  - [tracking_number](https://github.com/jkeen/tracking_number)


### I am creating a new library

If you are using this repo, it is most likely because you are writing a
library to get information out of tracking numbers.

1. Please check that your chosen programming language does not already have an
   implementation of a tracking number parser that uses these json files.
2. If you are creating a new library, great!  Open an issue and let us
   know.  We're happy to help!

### I found a bug or missing couriers.

- Open an issue and specify the tracking numbers and courier service.
- PRs: Feel free to modify any json file that does not specify it is
   auto-generated by a script.  Run `./lint_json.sh` to clean up and
   validate the json file (you may need jq or other dependencies).

---

# Helpful links

For finding the appropriate regular expressions and check digit
algorithms for various couriers.

- misc:
  - http://www.gs1-128.info/sscc-18/
  - http://answers.google.com/answers/threadview/id/207899.html
- s10:
  - http://www.upu.int/uploads/tx_sbdownloader/S10TechnicalStandard.pdf
- fedex:
  - barcode spec: http://images.fedex.com/us/solutions/ppe/FedEx_Ground_Label_Layout_Specification.pdf
  - updated barcode spec: http://www.fedex.com/us/gsn/barcode_guide.pdf
  - http://stackoverflow.com/questions/15744704/how-to-calculate-a-fedex-smartpost-tracking-number-check-digit
  - TODO: possible variation on fedex18:
  > 20 charss { "fedexsscc-18": "regex": "\d{2}(?<container_type>\d)(?<shipper_id>\d{7})(?<serial>\d{9})(?<check>\d)"}
        "UCC/EAN 128": "regex": ""
- usps:
  - http://about.usps.com/publications/pub97.pdf
    - "Electronic File Number"
    - "Package Identification Code (PIC)"
  - 13 char code uses two check digit algos:
    - mod10 (for domestic only)
    - s10 (for international or domestic mail)
  - other links:
    - http://about.usps.com/publications/pub97/pub97_appj_020.htm
    - http://about.usps.com/publications/pub97/pub97_appj_021.htm
